> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
>
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Gimme your password:
>
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Gimme your password:
>
Password reset, 2 step(s) missing
== Use your fido device foo ==
Press Enter to wait for authentication or enter 'r' to go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Plug your fido device and press with your thumb:
>
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Gimme your password:
>
Password reset, 2 step(s) missing
== Use your fido device foo ==
Press Enter to wait for authentication or enter 'r' to go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Plug your fido device and press with your thumb:
>
Password reset, 1 step(s) missing
== Password reset ==
  1. Proceed with password update
  2. Skip
Or enter 'r' to go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose action:
>
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Gimme your password:
>
Password reset, 2 step(s) missing
== Use your fido device foo ==
Press Enter to wait for authentication or enter 'r' to go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Plug your fido device and press with your thumb:
>
Password reset, 1 step(s) missing
== Password reset ==
  1. Proceed with password update
  2. Skip
Or enter 'r' to go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose action:
> 1
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Gimme your password:
>
Password reset, 2 step(s) missing
== Use your fido device foo ==
Press Enter to wait for authentication or enter 'r' to go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Plug your fido device and press with your thumb:
>
Password reset, 1 step(s) missing
== Password reset ==
  1. Proceed with password update
  2. Skip
Or enter 'r' to go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose action:
> 1
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Gimme your password:
>
Password reset, 2 step(s) missing
== Use your fido device foo ==
Press Enter to wait for authentication or enter 'r' to go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Plug your fido device and press with your thumb:
>
Password reset, 1 step(s) missing
== Password reset ==
  1. Proceed with password update
  2. Skip
Or enter 'r' to go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose action:
> 1
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is the same as the old one
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Gimme your password:
>
Password reset, 2 step(s) missing
== Use your fido device foo ==
Press Enter to wait for authentication or enter 'r' to go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Plug your fido device and press with your thumb:
>
Password reset, 1 step(s) missing
== Password reset ==
  1. Proceed with password update
  2. Skip
Or enter 'r' to go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose action:
> 1
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is the same as the old one
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password fails the dictionary check - it is based on a dictionary word
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Gimme your password:
>
Password reset, 2 step(s) missing
== Use your fido device foo ==
Press Enter to wait for authentication or enter 'r' to go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Plug your fido device and press with your thumb:
>
Password reset, 1 step(s) missing
== Password reset ==
  1. Proceed with password update
  2. Skip
Or enter 'r' to go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose action:
> 1
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is the same as the old one
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password fails the dictionary check - it is based on a dictionary word
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is the same as the old one
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Gimme your password:
>
Password reset, 2 step(s) missing
== Use your fido device foo ==
Press Enter to wait for authentication or enter 'r' to go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Plug your fido device and press with your thumb:
>
Password reset, 1 step(s) missing
== Password reset ==
  1. Proceed with password update
  2. Skip
Or enter 'r' to go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose action:
> 1
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is the same as the old one
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password fails the dictionary check - it is based on a dictionary word
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is the same as the old one
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is shorter than 8 characters
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Gimme your password:
>
Password reset, 2 step(s) missing
== Use your fido device foo ==
Press Enter to wait for authentication or enter 'r' to go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Plug your fido device and press with your thumb:
>
Password reset, 1 step(s) missing
== Password reset ==
  1. Proceed with password update
  2. Skip
Or enter 'r' to go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose action:
> 1
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is the same as the old one
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password fails the dictionary check - it is based on a dictionary word
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is the same as the old one
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is shorter than 8 characters
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Confirm Password:
>
────────────────────────────────────────────────────────────────────────────────
> ssh ${AUTHD_PAM_SSH_USER}@localhost ${AUTHD_PAM_SSH_ARGS}
== Provider selection ==
  1. local
  2. ExampleBroker
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Gimme your password:
>
Password reset, 2 step(s) missing
== Use your fido device foo ==
Press Enter to wait for authentication or enter 'r' to go back to select the authentication method
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Plug your fido device and press with your thumb:
>
Password reset, 1 step(s) missing
== Password reset ==
  1. Proceed with password update
  2. Skip
Or enter 'r' to go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Choose action:
> 1
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is the same as the old one
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password fails the dictionary check - it is based on a dictionary word
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is the same as the old one
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
The password is shorter than 8 characters
== Password reset ==
Enter 'r' to cancel the request and go back to choose the provider
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Enter your new password (3 days until mandatory):
>
(user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy@localhost) Confirm Password:
>
PAM Authenticate() finished for user 'user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy'
PAM AcctMgmt() finished for user 'user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy'
Environment:
  USER=user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy
  LOGNAME=user-mfa-with-reset-integration-pre-check-ssh-authenticate-user-with-mfa-and-reset-password-while-enforcing-policy
  HOME=${AUTHD_TEST_HOME}
  PATH=${AUTHD_TEST_PATH}
  SHELL=/bin/sh
  TERM=xterm-256color
  SSH_CLIENT=${AUTHD_TEST_SSH_CLIENT}
  SSH_CONNECTION=${AUTHD_TEST_SSH_CONNECTION}
  SSH_TTY=${AUTHD_TEST_SSH_TTY}
 SSHD: Connected to ssh via authd module! [TestSSHAuthenticate/Authenticate_user_with_mfa_and_reset_password_while_enforcing_policy]
Connection to localhost closed.
>
────────────────────────────────────────────────────────────────────────────────
