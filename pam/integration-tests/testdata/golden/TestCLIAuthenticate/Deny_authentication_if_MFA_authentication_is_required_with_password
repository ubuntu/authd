> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} require_mfa=true
Username: user name
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} require_mfa=true
Username: user-integration-simple-mfa-required-testcliauthenticate
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} require_mfa=true
  Select your provider

> 1. local
  2. ExampleBroker

  Press escape key to go back to user selection
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} require_mfa=true
Gimme your password:
>

  Press escape key to go back to select the authentication method
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} require_mfa=true
Gimme your password:
> ********

  Press escape key to go back to select the authentication method
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} require_mfa=true
PAM Error Message: Additional authentication factors are required
PAM Authenticate()
  User: "user-integration-simple-mfa-required-testcliauthenticate"
  Result: error: PAM exit code: 8
    Insufficient credentials to access authentication data
PAM Info Message: acct=incomplete
PAM AcctMgmt()
  User: "user-integration-simple-mfa-required-testcliauthenticate"
  Result: error: PAM exit code: 25
    The return value should be ignored by PAM dispatch
>
────────────────────────────────────────────────────────────────────────────────
