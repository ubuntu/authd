> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
>
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 2
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
Gimme your password:
>
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
Gimme your password:
>
== Authentication method selection ==
  1. Password authentication
  2. Send URL to user-integration-native-authenticate-user-switching-to-local-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33...
  5. Use your phone +1...
  6. Pin code
  7. Use a QR code
  8. Authentication code
Or enter 'r' to go back to choose the provider
Choose your authentication method:
>
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
Gimme your password:
>
== Authentication method selection ==
  1. Password authentication
  2. Send URL to user-integration-native-authenticate-user-switching-to-local-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33...
  5. Use your phone +1...
  6. Pin code
  7. Use a QR code
  8. Authentication code
Or enter 'r' to go back to choose the provider
Choose your authentication method:
> r
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
Gimme your password:
>
== Authentication method selection ==
  1. Password authentication
  2. Send URL to user-integration-native-authenticate-user-switching-to-local-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33...
  5. Use your phone +1...
  6. Pin code
  7. Use a QR code
  8. Authentication code
Or enter 'r' to go back to choose the provider
Choose your authentication method:
> r
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
>
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
Gimme your password:
>
== Authentication method selection ==
  1. Password authentication
  2. Send URL to user-integration-native-authenticate-user-switching-to-local-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33...
  5. Use your phone +1...
  6. Pin code
  7. Use a QR code
  8. Authentication code
Or enter 'r' to go back to choose the provider
Choose your authentication method:
> r
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> invalid-ID
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
Gimme your password:
>
== Authentication method selection ==
  1. Password authentication
  2. Send URL to user-integration-native-authenticate-user-switching-to-local-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33...
  5. Use your phone +1...
  6. Pin code
  7. Use a QR code
  8. Authentication code
Or enter 'r' to go back to choose the provider
Choose your authentication method:
> r
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> invalid-ID
PAM Error Message: Unsupported input
Choose your provider:
>
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
Gimme your password:
>
== Authentication method selection ==
  1. Password authentication
  2. Send URL to user-integration-native-authenticate-user-switching-to-local-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33...
  5. Use your phone +1...
  6. Pin code
  7. Use a QR code
  8. Authentication code
Or enter 'r' to go back to choose the provider
Choose your authentication method:
> r
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> invalid-ID
PAM Error Message: Unsupported input
Choose your provider:
> 555
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
Gimme your password:
>
== Authentication method selection ==
  1. Password authentication
  2. Send URL to user-integration-native-authenticate-user-switching-to-local-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33...
  5. Use your phone +1...
  6. Pin code
  7. Use a QR code
  8. Authentication code
Or enter 'r' to go back to choose the provider
Choose your authentication method:
> r
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> invalid-ID
PAM Error Message: Unsupported input
Choose your provider:
> 555
PAM Error Message: Invalid selection
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
>
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
Gimme your password:
>
== Authentication method selection ==
  1. Password authentication
  2. Send URL to user-integration-native-authenticate-user-switching-to-local-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33...
  5. Use your phone +1...
  6. Pin code
  7. Use a QR code
  8. Authentication code
Or enter 'r' to go back to choose the provider
Choose your authentication method:
> r
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> invalid-ID
PAM Error Message: Unsupported input
Choose your provider:
> 555
PAM Error Message: Invalid selection
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 1
────────────────────────────────────────────────────────────────────────────────
> ./pam_authd login socket=${AUTHD_TEST_TAPE_SOCKET} force_native_client=true
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 2
== Password authentication ==
Enter 'r' to cancel the request and go back to select the authentication method
Gimme your password:
>
== Authentication method selection ==
  1. Password authentication
  2. Send URL to user-integration-native-authenticate-user-switching-to-local-broker@gmail.com
  3. Use your fido device foo
  4. Use your phone +33...
  5. Use your phone +1...
  6. Pin code
  7. Use a QR code
  8. Authentication code
Or enter 'r' to go back to choose the provider
Choose your authentication method:
> r
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> invalid-ID
PAM Error Message: Unsupported input
Choose your provider:
> 555
PAM Error Message: Invalid selection
== Provider selection ==
  1. local
  2. ExampleBroker
Choose your provider:
> 1
auth=incomplete
PAM Authenticate()
  User: "user-integration-native-authenticate-user-switching-to-local-broker"
  Result: error: PAM exit code: 25
    The return value should be ignored by PAM dispatch
PAM AcctMgmt()
  User: "user-integration-native-authenticate-user-switching-to-local-broker"
  Result: error: PAM exit code: 26
    Critical error - immediate abort
>
────────────────────────────────────────────────────────────────────────────────
